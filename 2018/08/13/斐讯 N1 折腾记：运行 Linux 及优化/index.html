<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>斐讯 N1 折腾记：运行 Linux 及优化 | 博客</title>

  
  <meta name="author" content="403 Forbidden">
  

  
  <meta name="description" content="咳咳咳，上篇教程教大家给斐讯 N1 降级并且刷了官改系统，可以当作一个电视盒子和下载机来使用。　　有些小伙伴可能不想把它当作电视盒子，就想把它当作 NAS 或者是服务器，但是总不能拿 Android 玩吧，Android 也不是针对服务器设计的。　　那么我们说过，N1 不仅能刷官改，还能运行 Lin">
  

  
  
  <meta name="keywords" content="">
  

  <meta id="viewport" name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">

  <meta property="og:title" content="斐讯 N1 折腾记：运行 Linux 及优化"/>

  <meta property="og:site_name" content="博客"/>

  
  <meta property="og:image" content="/favicon.ico"/>
  

  <link href="/favicon.ico" rel="icon">
  <link rel="alternate" href="/atom.xml" title="博客" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
</head>


<body>
<div class="blog">
  <div class="content">

    <header>
  <div class="site-branding">
    <h1 class="site-title">
      <a href="/">博客</a>
    </h1>
    <p class="site-description"></p>
  </div>
  <nav class="site-navigation">
    <ul>
      
        <li><a href="/">主页</a></li>
      
        <li><a href="/categories">分类</a></li>
      
        <li><a href="/about.html">关于</a></li>
      
    </ul>
  </nav>
</header>

    <main class="site-main posts-loop">
    <article>

  
    
    <h3 class="article-title"><span>斐讯 N1 折腾记：运行 Linux 及优化</span></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2018/08/13/斐讯 N1 折腾记：运行 Linux 及优化/" rel="bookmark">
        <time class="entry-date published" datetime="2018-08-13T06:16:02.000Z">
          2018-08-13
        </time>
      </a>
    </span>
  </div>


  

  <div class="article-content">
    <div class="entry">
      
        <p>　　咳咳咳，上篇教程教大家给斐讯 N1 降级并且刷了官改系统，可以当作一个电视盒子和下载机来使用。<br>　　有些小伙伴可能不想把它当作电视盒子，就想把它当作 NAS 或者是服务器，但是总不能拿 Android 玩吧，Android 也不是针对服务器设计的。<br>　　那么我们说过，N1 不仅能刷官改，还能运行 Linux，而且是完整的 Linux 发行版，用 Linux 当服务器、NAS、下载机，包括电视盒子，体验总是要比 Android 好的。<br>　　这篇教程就教大家如何在斐讯 N1 运行 Linux 以及后续的优化，在此之前，需要将你的 N1 降级并刷入 webpad 的官改固件，或者只刷入降级关键分区（感谢群里的小伙伴反馈）。传送门：<a href="/2018/08/12/%E6%96%90%E8%AE%AF%20N1%20%E6%8A%98%E8%85%BE%E8%AE%B0%EF%BC%9A%E9%99%8D%E7%BA%A7%E5%8F%8A%E5%88%B7%E5%85%A5%E5%AE%98%E6%94%B9/">《斐讯N1折腾记：降级及刷入官改》</a></p>
<h2 id="制作-Linux-启动盘"><a href="#制作-Linux-启动盘" class="headerlink" title="制作 Linux 启动盘"></a>制作 Linux 启动盘</h2><p>　　N1 运行 Linux 的原理是通电的时候引导 U 盘里的系统<br>　　所以我们需要准备一个 U 盘来制作启动盘，U 盘大小推荐不低于 8G，连续读写速度推荐达到 30M/s，随机读写速度推荐达到 10M/s。最好是买个全新的，如果是旧的，提前备份好 U 盘内数据。<br>　　N1 运行的 Linux 发行版叫做 Armbian，玩过树莓派的小伙伴应该对这个系统不陌生，是适用于 ARM 架构的 Debian 和 Ubuntu。</p>
<blockquote>
<p><strong>下载地址</strong></p>
<p>Armbian：<br><a href="https://yadi.sk/d/pHxaRAs-tZiei" target="_blank" rel="noopener">https://yadi.sk/d/pHxaRAs-tZiei</a><br><a href="https://mega.nz/#F!j9QSDQSQ!6WpasOlbZYIInfw6yo4phQ" target="_blank" rel="noopener">https://mega.nz/#F!j9QSDQSQ!6WpasOlbZYIInfw6yo4phQ</a><br><a href="https://share.weiyun.com/5eCvcvS" target="_blank" rel="noopener">https://share.weiyun.com/5eCvcvS</a> （部分搬运）密码：mivmcn<br>启动盘制作工具：<a href="https://www.alexpage.de/usb-image-tool/download/" target="_blank" rel="noopener">https://www.alexpage.de/usb-image-tool/download/</a></p>
</blockquote>
<p>　　里面有好几个版本，下载最新的 5.44 版本，然后选择 kernel_3.14，3.14 内核在 N1 上面使用最好，WiFi、蓝牙都可以正常工作，如果你不需要蓝牙和 WiFi，也可以使用 4.16 版本。</p>
<blockquote>
<p><strong>IMG 文件名含义</strong></p>
<p>例如：<code>Armbian_5.44_S9xxx_Debian_stretch_3.14.29_server_20180601.img</code><br>Armbian：这个就不多说了<br>5.44：Armbian 的版本号<br>S9xxx：适用的 CPU<br>Debian：基于 Debian 编译的，另外还有 Ubuntu。<br>stretch：Debian 或 Ubuntu 的发行版代号，stretch 表示的是 Debian 9。<br>3.14.29：Linux 内核版本号<br>server：桌面环境，Server 代表的是服务器版，没桌面环境，其他的代表的是相应的桌面环境，比如：xfce、mate。<br>20180601：编译日期</p>
</blockquote>
<p>　　小白推荐使用 Ubuntu，桌面环境推荐使用 mate。我推荐使用 Debian Server，做一个真正的服务器。<br>　　下面我会以 Armbian_5.44_S9xxx_Debian_stretch_3.14.29_server_20180601 版为例<br>　　首先格式化你的 U 盘分区格式为 FAT32，推荐最好把 U 盘分区全部删除。<br>　　打开启动盘制作工具：左侧选择你的 U 盘 → 点击 [Restore] → 选择 Linux 镜像文件 → 提示框点击 [是] → 等待制作完成<br>　　制作完成后，会出现一个名为 BOOT 的分区，打开它。如果你把分区全部删除了，BOOT 分区默认是 FAT16 格式，Windows 是不会显示的，可以使用 Ubuntu 来访问。<br>　　把<code>dtb</code>文件夹里的<code>gxl_p230_2g.dtb</code>复制到 BOOT 分区的根目录并重命名为<code>dtb.img</code>。如果是 4.16 内核，dtb 文件是<code>meson-gxl-s905d-p230.dtb</code>。<br>　　将 N1 断电，插上 U 盘、网线，最好是插靠近 HDMI 接口那个 USB 接口，通电开机。<br>　　正常情况下顺利开机并进入 Linux 系统，如果没有进入 Linux 系统而是进入了 Android 系统，ADB 连接至 N1，输入<code>adb shell reboot update</code>。<br>　　接下来的操作我会以 SSH 远程连接为例，如果你使用 HDMI 连接显示器也可以，这种情况推荐你连接一个 USB HUB，方便连接鼠标和键盘，当然，如果你用的是 Server，那么就不需要鼠标了。<br>　　用户：root<br>　　密码：1234<br>　　如何获取 N1 运行 Linux 的 IP？打开 cmd，输入<code>nslookup amlogic</code>，如果<code>amlogic</code>无法解析IP，可以尝试解析<code>aml</code>。<br>　　首次登陆需要重置密码，先输入当前密码（1234），再输入新密码以及确认新密码。<br>　　设置完密码之后会让你新建一个普通用户，如果是使用 Server，直接按 Ctrl + C 跳过。如果是使用桌面版，推荐创建一个普通用户，按照提示操作即可。<br>　　跳过之后，再次使用 SSH 连接。<br>　　这时候，整个系统就可以用了，不过我们需要做一些小工作。</p>
<h2 id="小工作"><a href="#小工作" class="headerlink" title="小工作"></a>小工作</h2><p>　　加载 WiFi 驱动：<code>modprobe dhd &amp;&amp; echo dhd &gt;&gt; /etc/modules</code><br>　　设置时区：<code>echo &quot;Asia/Shanghai&quot; &gt; /etc/timezone &amp;&amp; ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime</code><br>　　删除默认DNS：<code>rm /etc/resolvconf/resolv.conf.d/head &amp;&amp; touch /etc/resolvconf/resolv.conf.d/head &amp;&amp; systemctl restart network-manager.service</code><br>　　注：在重启系统后，输入<code>cat /etc/resolv.conf</code>，查看返回结果的第一行是否为<code>nameserver 8.8.8.8</code>，如果不是，则表示删除成功，如果是，则再执行一次删除命令。<br>　　停止红外支持：<code>systemctl stop lircd.service lircd-setup.service lircd.socket lircd-uinput.service lircmd.service</code><br>　　删除红外支持：<code>apt remove -y lirc &amp;&amp; apt autoremove -y</code><br>　　N1 没有红外，而且由于红外支持找不到红外，一直给系统日志写错误。<br>　　重启系统：<code>reboot</code><br>　　更新软件包：<code>apt update &amp;&amp; apt upgrade -y</code></p>
<h3 id="挂载外置存储设备"><a href="#挂载外置存储设备" class="headerlink" title="挂载外置存储设备"></a>挂载外置存储设备</h3><p>　　推荐把外置存储设备分区格式化为 ext4 格式，不推荐使用 NTFS 格式。<br>　　如果你的外置存储设备是 NTFS 格式，可以使用<code>mkfs.ext4</code>命令将你的外置存储设备格式化为 ext4 格式，格式化前提前备份数据。<br>　　可以用<code>fdisk -l</code>查看你的外置存储设备是那个设备，一般是<code>/dev/sdb</code>，分区是<code>/dev/sdb1</code>，如果有多个分区，依次类推。<br>　　输入<code>mkfs.ext4 /dev/sdb1</code>将分区格式化为 ext4，格式化完成后使用<code>fdisk -l</code>查看是否格式化成功，如果分区的 Type 属性为 Linux（如下图所示），表示分区为 ext4/3。</p>
<p><a href="/uploads/2018/08/fdisk.png"><img src="/uploads/2018/08/fdisk.png" alt="fdisk"></a></p>
<p>　　格式化成功后，为了方便挂载，可以给分区设置一个卷标。<br>　　命令：<code>e2label</code><br>　　设置卷标示例：<code>e2label /dev/sdb1 H1</code><br>　　查看卷标示例：<code>e2label /dev/sdb1</code><br>　　然后就可以挂载分区了<br>　　挂载分区示例：<code>echo &quot;LABEL=H1 /mnt ext4 defaults,noatime,nodiratime 0 2&quot; &gt;&gt; /etc/fstab</code><br>　　此命令会将卷标为 H1 的分区挂载到 /mnt 目录下<br>　　重启系统使挂载生效</p>
<h3 id="Samba-网络共享"><a href="#Samba-网络共享" class="headerlink" title="Samba 网络共享"></a>Samba 网络共享</h3><p>　　使用 Samba 将外置存储设备共享给其他设备<br>　　Samba 可以使用 Armbian 自带的一个可视化菜单来配置，非常方便。<br>　　启动 Armbian 配置菜单：<code>armbian-config</code><br>　　选择 [Software] → [Softy] → 选中 (空格) [Samba] → 回车 → 输入 samba 用户名和密码 → 工作组填写 WORKGROUP → 等待安装完成<br>　　安装后，它会自动弹出修改配置文件的界面。</p>
<p><a href="/uploads/2018/08/samba.png"><img src="/uploads/2018/08/samba.png" alt="samba"></a></p>
<p>　　将红框里的内容删除<br>　　将 ext 的 path 改为 /mnt，如果你的挂载路径不是 /mnt，则改为你的挂载路径。<br>　　按下 TAB 键 → 选择 [OK] → 保存退出<br>　　Samba 网络共享配置完成</p>
<h2 id="后话"><a href="#后话" class="headerlink" title="后话"></a>后话</h2><p>　　小山觉得，既然斐讯 N1 的定位是 NAS，那么运行 Android 系统是显然满足不了 NAS 这个属性的，只有运行稳定且高效的 Linux 才可以称为 NAS。<br>　　Linux 有着更多的扩展性，你可以在上面任意的折腾，比如搭建个开发环境，Web 服务器等等。<br>　　总而言之，几十块钱买个 N1 这样的玩具，小山觉得是非常值的。<br>　　还是那句话：文章有什么不懂的地方，欢迎在下方或者在QQ群告诉我。<br>　　以后如果我想到 N1 的更多玩法会继续分享给大家的，再次感谢所有为 N1 可玩性付出的人。<br>　　本篇文章参考了以下资料：</p>
<ul>
<li><a href="https://forum.armbian.com/topic/2419-armbian-for-amlogic-s905-and-s905x/" target="_blank" rel="noopener">https://forum.armbian.com/topic/2419-armbian-for-amlogic-s905-and-s905x/</a></li>
<li><a href="http://www.right.com.cn/forum/thread-323198-1-1.html" target="_blank" rel="noopener">http://www.right.com.cn/forum/thread-323198-1-1.html</a></li>
<li><a href="http://www.right.com.cn/forum/thread-326034-1-1.html" target="_blank" rel="noopener">http://www.right.com.cn/forum/thread-326034-1-1.html</a></li>
</ul>
<p>　　转载自 <a href="https://www.mivm.cn/phicomm-n1-linux/" target="_blank" rel="noopener">https://www.mivm.cn/phicomm-n1-linux/</a></p>

      
    </div>

  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    
      

    <span class="post-categories">
      <i class="icon-categories"></i>
        <a href="/categories/斐讯/">斐讯</a>
    </span>
    

    

    </div>

    
  </div>
</article>

  

	<section id="comment" class="comment">
	  <div id="disqus_thread">
	  <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
	  </div>
	</section>

	<script type="text/javascript">
	var disqus_shortname = 'futa-ooo';
	(function(){
	  var dsq = document.createElement('script');
	  dsq.type = 'text/javascript';
	  dsq.async = true;
	  dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
	  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	}());
	(function(){
	  var dsq = document.createElement('script');
	  dsq.type = 'text/javascript';
	  dsq.async = true;
	  dsq.src = '//' + disqus_shortname + '.disqus.com/count.js';
	  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	}());
	</script>




    </main>

    <footer class="site-footer">
  <p class="site-info">
    Proudly powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and
    Theme by <a href="https://github.com/CodeDaraW/Hacker" target="_blank">Hacker</a>
    </br>
    
    &copy; 2018 403 Forbidden
    
  </p>
</footer>
    
  </div>
</div>
</body>
</html>