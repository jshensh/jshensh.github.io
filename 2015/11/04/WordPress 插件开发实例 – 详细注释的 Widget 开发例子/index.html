<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>WordPress 插件开发实例 – 详细注释的 Widget 开发例子 | 博客</title>

  
  <meta name="author" content="403 Forbidden">
  

  
  <meta name="description" content="在 wp-content\plugins 下创建 example-widget.php 代码如下 :
`&amp;lt;?php/**

Plugin Name: Example Widget
Plugin URI: http://example.com/widget
Description: A widg">
  

  
  
  <meta name="keywords" content="">
  

  <meta id="viewport" name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">

  <meta property="og:title" content="WordPress 插件开发实例 – 详细注释的 Widget 开发例子"/>

  <meta property="og:site_name" content="博客"/>

  
  <meta property="og:image" content="/favicon.ico"/>
  

  <link href="/favicon.ico" rel="icon">
  <link rel="alternate" href="/atom.xml" title="博客" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
</head>


<body>
<div class="blog">
  <div class="content">

    <header>
  <div class="site-branding">
    <h1 class="site-title">
      <a href="/">博客</a>
    </h1>
    <p class="site-description"></p>
  </div>
  <nav class="site-navigation">
    <ul>
      
        <li><a href="/">主页</a></li>
      
        <li><a href="/archives">归档</a></li>
      
    </ul>
  </nav>
</header>

    <main class="site-main posts-loop">
    <article>

  
    
    <h3 class="article-title"><span>WordPress 插件开发实例 – 详细注释的 Widget 开发例子</span></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2015/11/04/WordPress 插件开发实例 – 详细注释的 Widget 开发例子/" rel="bookmark">
        <time class="entry-date published" datetime="2015-11-04T02:24:27.000Z">
          2015-11-04
        </time>
      </a>
    </span>
  </div>


  

  <div class="article-content">
    <div class="entry">
      
        <p>在 wp-content\plugins 下创建 example-widget.php 代码如下 :</p>
<p>`&lt;?php<br>/**</p>
<ul>
<li>Plugin Name: Example Widget</li>
<li>Plugin URI: <a href="http://example.com/widget" target="_blank" rel="noopener">http://example.com/widget</a></li>
<li>Description: A widget that serves as an example for developing more advanced widgets.</li>
<li>Version: 0.1</li>
<li>Author: Justin Tadlock</li>
<li>Author URI: <a href="http://justintadlock.com" target="_blank" rel="noopener">http://justintadlock.com</a><br>*</li>
<li>This program is distributed in the hope that it will be useful,</li>
<li>but WITHOUT ANY WARRANTY; without even the implied warranty of</li>
<li>MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.<br>*/</li>
</ul>
<p>/**</p>
<ul>
<li>Add function to widgets_init that’ll load our widget.</li>
<li>@since 0.1<br>*/<br>add_action( ‘widgets_init’, ‘example_load_widgets’ );</li>
</ul>
<p>/**</p>
<ul>
<li>Register our widget.</li>
<li>‘Example_Widget’ is the widget class used below.<br>*</li>
<li>@since 0.1<br>*/<br>function example_load_widgets() {<br> register_widget( ‘Example_Widget’ );<br>}</li>
</ul>
<p>/**</p>
<ul>
<li>Example Widget class.</li>
<li>This class handles everything that needs to be handled with the widget:</li>
<li>the settings, form, display, and update.  Nice!<br>*</li>
<li><p>@since 0.1<br>*/<br>class Example_Widget extends WP_Widget {</p>
<p> /**</p>
<ul>
<li><p>Widget setup.<br><em>/<br>function Example_Widget() {<br> /</em> Widget settings. */<br> $widget_ops = array( ‘classname’ =&gt; ‘example’, ‘description’ =&gt; __(‘An example widget that displays a person\’s name and sex.’, ‘example’) );</p>
<p> /<em> Widget control settings. </em>/<br> $control_ops = array( ‘width’ =&gt; 300, ‘height’ =&gt; 350, ‘id_base’ =&gt; ‘example-widget’ );</p>
<p> /<em> Create the widget. </em>/<br> $this-&gt;WP_Widget( ‘example-widget’, __(‘Example Widget’, ‘example’), $widget_ops, $control_ops );<br>}</p>
<p>/**</p>
</li>
<li><p>How to display the widget on the screen.<br>*/<br>function widget( $args, $instance ) {<br> extract( $args );</p>
<p> /<em> Our variables from the widget settings. </em>/<br> $title = apply_filters(‘widget_title’, $instance[‘title’] );<br> $name = $instance[‘name’];<br> $sex = $instance[‘sex’];<br> $show_sex = isset( $instance[‘show_sex’] ) ? $instance[‘show_sex’] : false;</p>
<p> /<em> Before widget (defined by themes). </em>/<br> echo $before_widget;</p>
<p> /<em> Display the widget title if one was input (before and after defined by themes). </em>/<br> if ( $title )</p>
<pre><code>echo $before_title . $title . $after_title;
</code></pre><p> /<em> Display name from widget settings if one was input. </em>/<br> if ( $name )</p>
<pre><code>printf( &apos;&lt;p&gt;&apos; . __(&apos;Hello. My name is %1$s.&apos;, &apos;example&apos;) . &apos;&lt;/p&gt;&apos;, $name );
</code></pre><p> /<em> If show sex was selected, display the user’s sex. </em>/<br> if ( $show_sex )</p>
<pre><code>printf( &apos;&lt;p&gt;&apos; . __(&apos;I am a %1$s.&apos;, &apos;example.&apos;) . &apos;&lt;/p&gt;&apos;, $sex );
</code></pre><p> /<em> After widget (defined by themes). </em>/<br> echo $after_widget;<br>}</p>
<p>/**</p>
</li>
<li><p>Update the widget settings.<br>*/<br>function update( $new_instance, $old_instance ) {<br> $instance = $old_instance;</p>
<p> /<em> Strip tags for title and name to remove HTML (important for text inputs). </em>/<br> $instance[‘title’] = strip_tags( $new_instance[‘title’] );<br> $instance[‘name’] = strip_tags( $new_instance[‘name’] );</p>
<p> /<em> No need to strip tags for sex and show_sex. </em>/<br> $instance[‘sex’] = $new_instance[‘sex’];<br> $instance[‘show_sex’] = $new_instance[‘show_sex’];</p>
<p> return $instance;<br>}</p>
<p>/**</p>
</li>
<li>Displays the widget settings controls on the widget panel.</li>
<li>Make use of the get_field_id() and get_field_name() function</li>
<li><p>when creating your form elements. This handles the confusing stuff.<br>*/<br>function form( $instance ) {</p>
<p> /<em> Set up some default widget settings. </em>/<br> $defaults = array( ‘title’ =&gt; <strong>(‘Example’, ‘example’), ‘name’ =&gt; </strong>(‘John Doe’, ‘example’), ‘sex’ =&gt; ‘male’, ‘show_sex’ =&gt; true );<br> $instance = wp_parse_args( (array) $instance, $defaults ); ?&gt;</p>
 <!-- Widget Title: Text Input -->
 <p><br>     <label for="<?php echo $this->get_field_id( 'title' ); ?>">&lt;?php _e(‘Title:’, ‘hybrid’); ?&gt;</label><br>     <input id="<?php echo $this->get_field_id( 'title' ); ?>" name="<?php echo $this->get_field_name( 'title' ); ?>" value="<?php echo $instance['title']; ?>" style="width:100%;"><br> </p>

 <!-- Your Name: Text Input -->
 <p><br>     <label for="<?php echo $this->get_field_id( 'name' ); ?>">&lt;?php _e(‘Your Name:’, ‘example’); ?&gt;</label><br>     <input id="<?php echo $this->get_field_id( 'name' ); ?>" name="<?php echo $this->get_field_name( 'name' ); ?>" value="<?php echo $instance['name']; ?>" style="width:100%;"><br> </p>

 <!-- Sex: Select Box -->
 <p><br>     <label for="<?php echo $this->get_field_id( 'sex' ); ?>">&lt;?php _e(‘Sex:’, ‘example’); ?&gt;</label><br>     <select id="<?php echo $this->get_field_id( 'sex' ); ?>" name="<?php echo $this->get_field_name( 'sex' ); ?>" class="widefat" style="width:100%;"><br>         &lt;option &lt;?php if ( ‘male’ == $instance[‘format’] ) echo ‘selected=”selected”‘; ?&gt;&gt;male<br>         &lt;option &lt;?php if ( ‘female’ == $instance[‘format’] ) echo ‘selected=”selected”‘; ?&gt;&gt;female<br>     </select><br> </p>

 <!-- Show Sex? Checkbox -->
 <p><br>     &lt;input class=”checkbox” type=”checkbox” &lt;?php checked( $instance[‘show_sex’], true ); ?&gt; id=”&lt;?php echo $this-&gt;get_field_id( ‘show_sex’ ); ?&gt;” name=”&lt;?php echo $this-&gt;get_field_name( ‘show_sex’ ); ?&gt;” /&gt;<br>     <label for="<?php echo $this->get_field_id( 'show_sex' ); ?>">&lt;?php _e(‘Display sex publicly?’, ‘example’); ?&gt;</label><br> </p>

<p>&lt;?php<br>}<br>}</p>
</li>
</ul>
</li>
</ul>
<p>?&gt;<br><code>`</code></p>
<p>转载自：<a href="http://summerbluet.com/225" target="_blank" rel="noopener">http://summerbluet.com/225</a></p>

      
    </div>

  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    
      

    <span class="post-categories">
      <i class="icon-categories"></i>
        <a href="/categories/Web-开发/">Web 开发</a>
    </span>
    

    

    </div>

    
  </div>
</article>


    </main>

    <footer class="site-footer">
  <p class="site-info">
    Proudly powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and
    Theme by <a href="https://github.com/CodeDaraW/Hacker" target="_blank">Hacker</a>
    </br>
    
    &copy; 2018 403 Forbidden
    
  </p>
</footer>
    
  </div>
</div>
</body>
</html>